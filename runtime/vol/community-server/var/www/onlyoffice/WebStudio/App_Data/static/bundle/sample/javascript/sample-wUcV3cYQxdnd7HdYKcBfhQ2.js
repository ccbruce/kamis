typeof ASC=="undefined"&&(ASC={});typeof ASC.Sample=="undefined"&&(ASC.Sample=function(){return{}}());ASC.Sample.PageScript=function(){function t(n){var e,r,s,t,h;jq("#peopleFilterContent").html("");var o=null,u=null,i=null,f=null;n.forEach(function(n){switch(n.id){case"sorter":o=n.params.sortOrder=="ascending";break;case"text":u=n.params.value.toLowerCase();break;case"admin":i=n.params.value;break;case"user":i=n.params.value;break;case"user-group":f=n.params.value}});e=window.UserManager.getAllUsers(!0);r=[];for(s in e)(t=e[s],f==null||(h=jq.map(t.groups,function(n){return n.id}),h.includes(f)))&&(i==null||t.isAdmin==i)&&(u==null||t.displayName.toLowerCase().indexOf(u)!=-1)&&r.push(t);r.sort(function(n,t){var i=n.displayName<t.displayName?-1:n.displayName>t.displayName?1:0;return o?i:i*-1});r.forEach(function(n){jq("#peopleFilterContent").append(jq("<a/>").attr("href",n.profileUrl).append(jq("<img/>").attr("src",n.avatarSmall).attr("title",n.displayName)))})}function u(){if(jq("#select").length){jq("#select").tlCombobox({align:"left"});jq.dropdownToggle({switcherSelector:"#dropdownBtn",dropdownID:"dropdownPanel",addTop:10,addLeft:0,rightPos:!1});jq("#dropdownPanel").on("click",".dropdown-item",function(){jq("#dropdownBtn span").text(jq(this).text());jq("#dropdownPanel").hide()});jq("#popupBtn").on("click",function(){window.StudioBlockUIManager.blockUI("#popupDialog",500)});jq("#popupDialog").on("click",".close-popup",function(){window.LoadingBanner.hideLoaderBtn("#popupDialog");window.PopupKeyUpActionProvider.CloseDialog()});jq("#popupDialog").on("click",".show-loading",function(){window.LoadingBanner.showLoaderBtn("#popupDialog")});jq("#popupDialog").on("click",".show-success",function(){window.LoadingBanner.hideLoaderBtn("#popupDialog");window.LoadingBanner.showMesInfoBtn("#popupDialog","success message","success")});jq("#popupDialog").on("click",".show-error",function(){window.LoadingBanner.hideLoaderBtn("#popupDialog");window.LoadingBanner.showMesInfoBtn("#popupDialog","error message","error")})}}function f(){if(jq("#userSelector").length){var n=jq("#userSelector");n.useradvancedSelector({itemsChoose:[],itemsDisabledIds:[],canadd:!1,showGroups:!0,onechosen:!0,withGuests:!1}).on("showList",function(n,t){jq(this).html(t.title+" (id: "+t.id+")")});jq("#emailSelector").AdvancedEmailSelector("init",{isInPopup:!1,items:['"test.ru" <test@test.ru>;','"BROKEN" <net@net.>;',"<test@test.org>;","NOT VALID",{name:"test.com",email:"test@test.com",isValid:!0}],maxCount:20,onChangeCallback:function(){console.log("changed")}});r()}}function e(){if(jq("#addBtn").length){jq("#addBtn").on("click",function(){jq("#itemValue").val("");jq("#itemId").val("");window.StudioBlockUIManager.blockUI("#itemDialog",230)});jq("#itemsTbl").on("click",".editBtn",function(){var n=jq(this).attr("data-id");jq("#itemValue").val(jq("#itemValue_"+n).text().trim());jq("#itemId").val(n);window.StudioBlockUIManager.blockUI("#itemDialog",230)});jq("#itemsTbl").on("click",".deleteBtn",function(){var n=jq(this);jq.ajax({url:"/api/2.0/sample/delete/"+n.attr("data-id")+".json",type:"DELETE"}).done(function(){n.parents("tr:first").remove()})});window.LoadingBanner.displayLoading(!0);jq.get("/api/2.0/sample/read.json",function(n){n&&n.response&&n.response.length&&jq.each(n.response,function(n,t){jq("#itemTmpl").tmpl(t).appendTo("#itemsTbl tbody")})}).always(function(){window.LoadingBanner.hideLoading()});jq("#itemDialog").on("click",".close-popup",function(){window.PopupKeyUpActionProvider.CloseDialog()});jq("#itemDialog").on("click",".save-popup",function(){var n=jq("#itemId").val(),t=jq("#itemValue").val();n?jq.ajax({type:"PUT",url:"/api/2.0/sample/update.json",data:{id:n,value:t}}).done(function(){jq("#itemValue_"+n).text(t);window.PopupKeyUpActionProvider.CloseDialog()}):jq.ajax({type:"POST",url:"/api/2.0/sample/create.json",data:{value:t}}).done(function(n){jq("#itemTmpl").tmpl({id:n.response.id,value:n.response.value}).appendTo("#itemsTbl tbody");window.PopupKeyUpActionProvider.CloseDialog()})})}}var n=!1,i=null,r=function(){jq("#peopleFilter").advansedFilter({maxfilters:-1,anykey:!1,store:!1,hintDefaultDisable:!0,sorters:[{id:"by-name",title:"Name",dsc:!1,def:!0}],filters:[{type:"combobox",id:"admin",title:"Admin",filtertitle:"Type label",group:"User Type Title",groupby:"user-type",options:[{value:1,classname:"admin",title:"Admin",def:!0},{value:0,classname:"user",title:"User or Guest"}],hashmask:"type/{0}"},{type:"combobox",id:"user",title:"User or Guest",filtertitle:"Type label",group:"User Type Title",groupby:"user-type",options:[{value:1,classname:"admin",title:"Admin"},{value:0,classname:"user",title:"User or Guest",def:!0}],hashmask:"type/{0}"},{type:"group",id:"user-group",title:"Department label",group:"Department Title",hashmask:"group/{0}"}]}).on("setfilter",function(n,i,r,u,f){t(f)}).on("resetfilter",function(n,i,r,u){t(u)}).on("resetallfilters",function(){jq("#peopleFilterContent").html("")})},o=function(t){n||(n=!0,i=t,u(),f(),e())};return{init:o}}(jQuery);
(function(){function h(t){return typeof t=="string"&&(t=n.getElementById(t)),t}function t(n,t,r){if(i.addEventListener)n&&n.addEventListener(t,r,!1);else if(i.attachEvent){var u=function(){r.call(n,i.event)};n&&n.attachEvent("on"+t,u)}}function c(n,t){return n.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function l(n,t){c(n,t)||(n.className+=" "+t)}function f(n,t){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");n.className=n.className.replace(i," ")}function a(n){var t,u,i,f,e=r(n);return t=e.left,i=e.top,u=t+n.offsetWidth,f=i+n.offsetHeight,{left:t,right:u,top:i,bottom:f}}function v(t){var i,r,u;return!t.pageX&&t.clientX?(i=1,r=document.body,r.getBoundingClientRect&&(u=r.getBoundingClientRect(),i=(u.right-u.left)/r.clientWidth),{x:t.clientX/i+n.body.scrollLeft+n.documentElement.scrollLeft,y:t.clientY/i+n.body.scrollTop+n.documentElement.scrollTop}):{x:t.pageX,y:t.pageY}}function o(n){return n.replace(/.*(\/|\\)/,"")}function s(n){return/[.]/.exec(n)?/[^.]+$/.exec(n.toLowerCase()):""}var n=document,i=window,u=function(){var t=n.createElement("div");return function(n){t.innerHTML=n;var i=t.childNodes[0];return t.removeChild(i),i}}(),r,e;r=document.documentElement.getBoundingClientRect?function(n){var f=n.getBoundingClientRect(),e=n.ownerDocument,i=e.body,r=e.documentElement,o=r.clientTop||i.clientTop||0,s=r.clientLeft||i.clientLeft||0,t=1,u,h,c;return i.getBoundingClientRect&&(u=i.getBoundingClientRect(),t=(u.right-u.left)/i.clientWidth),t>1&&(o=0,s=0),h=f.top/t+(window.pageYOffset||r&&r.scrollTop/t||i.scrollTop/t)-o,c=f.left/t+(window.pageXOffset||r&&r.scrollLeft/t||i.scrollLeft/t)-s,{top:h,left:c}}:function(n){if(i.jQuery)return jQuery(n).offset();var t=0,r=0;do t+=n.offsetTop||0,r+=n.offsetLeft||0;while(n=n.offsetParent);return{left:r,top:t}};e=function(){var n=0;return function(){return"ValumsAjaxUpload"+n++}}();Ajax_upload=AjaxUpload=function(t,i){var r,u;t.jquery?t=t[0]:typeof t=="string"&&/^#.*/.test(t)&&(t=t.slice(1));t=h(t);this._input=null;this._button=t;this._disabled=!1;this._submitting=!1;this._justClicked=!1;this._parentDialog=n.body;this._isInPopup=!1;window.jQuery&&jQuery.ui&&jQuery.ui.dialog&&(r=jQuery(this._button).parents(".ui-dialog"),r.length&&(this._parentDialog=r[0]));this._settings={action:"upload.php",name:"userfile",id:null,title:"",data:{},autoSubmit:!0,responseType:!1,onChange:function(){},onSubmit:function(){},onComplete:function(){}};for(u in i)this._settings[u]=i[u];this._settings.parentDialog&&(this._parentDialog=this._settings.parentDialog);this._settings.isInPopup&&(this._isInPopup=this._settings.isInPopup);this._createInput();this._rerouteClicks()};AjaxUpload.prototype={setData:function(n){this._settings.data=n},disable:function(){this._disabled=!0},enable:function(){this._disabled=!1},destroy:function(){this._input&&(this._input.parentNode&&this._input.parentNode.removeChild(this._input),this._input=null)},_createInput:function(){var r=this,i=n.createElement("input"),u,f;i.setAttribute("type","file");i.setAttribute("name",this._settings.name);i.setAttribute("class","fileuploadinput"+(this._settings.name==="userfile"?"":this._settings.name));i.setAttribute("title",this._settings.title);this._settings.accept&&i.setAttribute("accept",this._settings.accept);u={position:"absolute",margin:"-5px 0 0 -175px",padding:0,width:"220px",height:"30px",fontSize:"14px",opacity:0,cursor:"pointer",display:"none",zIndex:2147483583};for(f in u)i.style[f]=u[f];i.style.opacity==="0"||(i.style.filter="alpha(opacity=0)");this._parentDialog.appendChild?this._parentDialog.appendChild(i):this._parentDialog.append(i);t(i,"change",function(){r.justClicked=!1;var n=o(this.value);r._settings.onChange.call(r,n,s(n))!=!1&&r._settings.autoSubmit&&r.submit()});/safari/i.test(navigator.userAgent)&&!window.chrome&&t(i,"click",function(){r.justClicked=!0;setTimeout(function(){r.justClicked=!1},3e3)});this._input=i},_rerouteClicks:function(){var i=this,u,e={top:0,left:0},o=!1;t(i._button,"mouseover",function(){i._input&&!o&&(o=!0,u=a(i._button),i._parentDialog!=n.body&&(i._isInPopup?(e.top=jq(i._button).offset().top-jq(i._button).position().top,e.left=jq(i._button).offset().left-jq(i._button).position().left):e=r(i._parentDialog)))});t(document,"mousemove",function(n){var t=i._input,r;if(!t||!o){!t||o||t.style.display=="none"||i.justClicked||(t.style.display="none");return}if(i._disabled){f(i._button,"hover");t.style.display="none";return}r=v(n);r.x>=u.left&&r.x<=u.right&&r.y>=u.top&&r.y<=u.bottom?(t.style.top=r.y-e.top+"px",t.style.left=r.x-e.left+"px",t.style.display="block",l(i._button,"hover")):(o=!1,i.justClicked||(t.style.display="none"),f(i._button,"hover"))})},_createIframe:function(){var i=e(),t=u('<iframe src="javascript:false;" name="'+i+'" />');return t.id=i,t.style.display="none",n.body.appendChild(t),t},submit:function(){var h=this,u=this._settings,f,i,r,e;this._input.value!==""&&(f=o(this._input.value),u.onSubmit.call(this,f,s(f))==!1?(n.body.removeChild(this._input),this._input=null,this._createInput()):(i=this._createIframe(),r=this._createForm(i),r.appendChild(this._input),r.submit(),n.body.removeChild(r),r=null,this._input=null,this._createInput(),e=!1,t(i,"load",function(){var t,r;if(i.src=="javascript:'%3Chtml%3E%3C/html%3E';"||i.src=="javascript:'<html><\/html>';"){e&&setTimeout(function(){n.body.removeChild(i)},0);return}(t=i.contentDocument?i.contentDocument:frames[i.id].document,t.readyState&&t.readyState!="complete")||t.body&&t.body.innerHTML=="false"||t.body&&t.body.innerHTML==""||(t.XMLDocument?r=t.XMLDocument:t.body?(r=t.body.innerHTML,u.responseType&&u.responseType.toLowerCase()=="json"&&(t.body.firstChild&&t.body.firstChild.nodeName.toUpperCase()=="PRE"&&(r=t.body.firstChild.firstChild.nodeValue),r=r?window.eval("("+r+")"):{})):r=t,u.onComplete.call(h,f,r),e=!0,i.src="javascript:'<html><\/html>';")})))},_createForm:function(t){var f=this._settings,i=u('<form method="post" enctype="multipart/form-data"><\/form>'),e,r;i.style.display="none";i.action=f.action;i.target=t.name;n.body.appendChild(i);for(e in f.data)r=n.createElement("input"),r.type="hidden",r.name=e,r.value=f.data[e],i.appendChild(r);return i}}})();
